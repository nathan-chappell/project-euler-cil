.assembly euler {}
.assembly extern mscorlib {}

.method public static void Main()
{
    .entrypoint
    .maxstack 4
    .locals init (int32, int32, int32) // acc, fib_{n}, fib_{n-1}
    ldc.i4.1
    stloc.1

    LOOP_BEGIN:
    // if fib_{n} is even, add to acc
    ldloc.1
    ldc.i4.2
    rem
    ldc.i4.1
    beq FIB_INC

    ACC:
    ldloc.0
    ldloc.1
    add
    stloc.0

    FIB_INC:
    ldloc.1
    dup
    ldloc.2
    add
    stloc.1
    stloc.2

    LOOP_COND:
    ldloc.1
    ldc.i4 4000000
    ldloc.1
    call void [mscorlib]System.Console::WriteLine(int32)
    blt.s LOOP_BEGIN

    ldstr "Result:"
    call void [mscorlib]System.Console::WriteLine(class System.String)
    ldloc.0
    call void [mscorlib]System.Console::WriteLine(int32)

    ret
}
